pipeline {
    agent any

    stages {
        stage('Environment Setup') {
            steps {
                // 设置环境，例如安装必要的软件或设置环境变量
                sh 'echo "Setting up the environment..."'
            }
        }

        stage('Checkout') {
            steps {
                // 从代码仓库拉取测试代码
                sh 'echo "pull code from test repo..."'
            }
        }

        stage('Test') {
            steps {
                // 使用测试工具（如JUnit、pytest等）进行测试
                sh 'echo "Running tests..."'
            }
        }
    }

    post {
        always {
            script {
                // 发送结果，通过邮件提醒
                emailext(
                    subject: "Jenkins Pipeline: ${currentBuild.fullDisplayName}",
                    body: "Pipeline build result: ${currentBuild.result}",
                    to: 'jx6198@buaa.edu.cn',
                    from: 'jiangx6198@163.com'
                )
            }
        }
    }
}
